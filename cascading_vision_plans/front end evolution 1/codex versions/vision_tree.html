<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cascading Vision Plans</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            padding: 2rem;
        }

        .tree-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Corporate card */
        .corporate-node {
            max-width: 600px;
            width: 100%;
        }

        /* Vertical line from corporate to children */
        .tree-connector {
            width: 2px;
            height: 40px;
            background-color: #6c757d;
        }

        /* Horizontal line above children */
        .children-container {
            position: relative;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
            padding-top: 20px;
        }

        .children-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: calc(100% - 100px);
            max-width: 800px;
            height: 2px;
            background-color: #6c757d;
        }

        /* Office cards */
        .office-node {
            position: relative;
            width: 280px;
            flex-shrink: 0;
        }

        /* Vertical line from horizontal bar to each office card */
        .office-node::before {
            content: '';
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 20px;
            background-color: #6c757d;
        }

        /* Card styling */
        .vision-card {
            border: 1px solid #dee2e6;
            height: 100%;
        }

        .vision-card .card-header {
            font-weight: 600;
            background-color: #e9ecef;
        }

        .corporate-node .card-header {
            background-color: #0d6efd;
            color: white;
        }

        .section-title {
            font-weight: 600;
            font-size: 0.9rem;
            color: #495057;
            border-bottom: 1px solid #dee2e6;
            padding-bottom: 0.25rem;
            margin-bottom: 0.5rem;
        }

        .metrics {
            display: flex;
            gap: 1rem;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .metric-label {
            color: #6c757d;
            font-size: 0.75rem;
        }

        .metric-value {
            font-weight: 600;
        }

        .measurables {
            font-size: 0.8rem;
            color: #6c757d;
            margin-bottom: 0.5rem;
        }

        .look-like-list {
            font-size: 0.85rem;
            padding-left: 1.25rem;
            margin-bottom: 0;
        }

        .look-like-list li {
            margin-bottom: 0.25rem;
        }

        .plan-section {
            margin-top: 1rem;
            padding-top: 0.75rem;
            border-top: 1px solid #dee2e6;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="tree-container" id="tree"></div>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>
        const visionData = {
            "id": "example-air",
            "name": "Example Air Systems",
            "level": "corporate",
            "vto": {
                "threeYearPicture": {
                    "futureDate": "2029-12-31",
                    "revenue": "$2.6B",
                    "profit": "$182M",
                    "measurables": "Sales Bookings, Gross Margin, Backlog",
                    "whatDoesItLookLike": [
                        "5 offices operating on unified EOS system",
                        "Industry leader in Texas HVAC market",
                        "Data Center division established in all major metros",
                        "Turnkey capabilities in every office",
                        "85% PM Utilization Rate company-wide"
                    ]
                },
                "oneYearPlan": {
                    "futureDate": "2026-12-31",
                    "revenue": "$1.72B",
                    "profit": "$112M",
                    "measurables": "Sales Bookings, Gross Margin"
                }
            },
            "children": [
                {
                    "id": "dfw",
                    "name": "DFW",
                    "vto": {
                        "threeYearPicture": {
                            "futureDate": "2029-12-31",
                            "revenue": "$1.18B",
                            "profit": "$83M",
                            "measurables": "Sales Bookings, Gross Margin, Backlog",
                            "whatDoesItLookLike": [
                                "Largest office in Example Air",
                                "Data Center team fully operational",
                                "Turnkey division established",
                                "Strong succession pipeline"
                            ]
                        },
                        "oneYearPlan": {
                            "futureDate": "2026-12-31",
                            "revenue": "$776M",
                            "profit": "$54M",
                            "measurables": "Sales Bookings, Gross Margin, Data Center Bookings, Turnkey"
                        }
                    }
                },
                {
                    "id": "houston",
                    "name": "Houston",
                    "vto": {
                        "threeYearPicture": {
                            "futureDate": "2029-12-31",
                            "revenue": "$787M",
                            "profit": "$55M",
                            "measurables": "Sales Bookings, Gross Margin, Backlog",
                            "whatDoesItLookLike": [
                                "Data Center team with dedicated leader",
                                "Industrial Turnkey capabilities",
                                "Service business at $50M",
                                "Strong account management"
                            ]
                        },
                        "oneYearPlan": {
                            "futureDate": "2026-12-31",
                            "revenue": "$518M",
                            "profit": "$34M",
                            "measurables": "Sales Bookings, Gross Margin, Data Center Bookings, Turnkey"
                        }
                    }
                },
                {
                    "id": "austin",
                    "name": "Austin",
                    "vto": {
                        "threeYearPicture": {
                            "futureDate": "2029-12-31",
                            "revenue": "$371M",
                            "profit": "$26M",
                            "measurables": "Sales Bookings, Gross Margin, Backlog",
                            "whatDoesItLookLike": [
                                "Data Center leader in Central Texas",
                                "Turnkey at $40M",
                                "Controls business established",
                                "AD Business operational"
                            ]
                        },
                        "oneYearPlan": {
                            "futureDate": "2026-12-31",
                            "revenue": "$244M",
                            "profit": "$16M",
                            "measurables": "Sales Bookings, Gross Margin, Backlog"
                        }
                    }
                },
                {
                    "id": "san-antonio",
                    "name": "San Antonio",
                    "vto": {
                        "threeYearPicture": {
                            "futureDate": "2029-12-31",
                            "revenue": "$140M",
                            "profit": "$9M",
                            "measurables": "Sales Bookings, Gross Margin, Backlog",
                            "whatDoesItLookLike": [
                                "RGV market fully developed",
                                "Hydronics leadership in region",
                                "Middle Market established",
                                "Service at $10M"
                            ]
                        },
                        "oneYearPlan": {
                            "futureDate": "2026-12-31",
                            "revenue": "$92M",
                            "profit": "$6M",
                            "measurables": "Sales Bookings, Gross Margin, Hydronics Bookings, Turnkey"
                        }
                    }
                },
                {
                    "id": "west-texas",
                    "name": "West Texas",
                    "vto": {
                        "threeYearPicture": {
                            "futureDate": "2029-12-31",
                            "revenue": "$130M",
                            "profit": "$8M",
                            "measurables": "Sales Bookings, Gross Margin, Backlog",
                            "whatDoesItLookLike": [
                                "Core equipment business strong",
                                "Hydronics presence established",
                                "Service team built out"
                            ]
                        },
                        "oneYearPlan": {
                            "futureDate": "2026-12-31",
                            "revenue": "$90M",
                            "profit": "$6M",
                            "measurables": "Sales Bookings, Gross Margin, Hydronics Bookings, Turnkey"
                        }
                    }
                }
            ]
        };

        function formatDate(dateStr) {
            if (!dateStr) return '';
            const date = new Date(dateStr);
            return date.getFullYear();
        }

        function renderThreeYearPicture(data) {
            if (!data) return '';

            const bullets = (data.whatDoesItLookLike || [])
                .map(item => `<li>${item}</li>`)
                .join('');

            return `
                <div class="three-year-section">
                    <div class="section-title">3-Year Picture (${formatDate(data.futureDate)})</div>
                    <div class="metrics">
                        <div>
                            <div class="metric-label">Revenue</div>
                            <div class="metric-value">${data.revenue || '-'}</div>
                        </div>
                        <div>
                            <div class="metric-label">Profit</div>
                            <div class="metric-value">${data.profit || '-'}</div>
                        </div>
                    </div>
                    <div class="measurables">Measurables: ${data.measurables || '-'}</div>
                    ${bullets ? `<ul class="look-like-list">${bullets}</ul>` : ''}
                </div>
            `;
        }

        function renderOneYearPlan(data) {
            if (!data) return '';

            return `
                <div class="plan-section">
                    <div class="section-title">1-Year Plan (${formatDate(data.futureDate)})</div>
                    <div class="metrics">
                        <div>
                            <div class="metric-label">Revenue</div>
                            <div class="metric-value">${data.revenue || '-'}</div>
                        </div>
                        <div>
                            <div class="metric-label">Profit</div>
                            <div class="metric-value">${data.profit || '-'}</div>
                        </div>
                    </div>
                    <div class="measurables">Measurables: ${data.measurables || '-'}</div>
                </div>
            `;
        }

        function renderCard(node, isCorporate) {
            const nodeClass = isCorporate ? 'corporate-node' : 'office-node';

            return `
                <div class="${nodeClass}">
                    <div class="card vision-card">
                        <div class="card-header">${node.name}</div>
                        <div class="card-body">
                            ${renderThreeYearPicture(node.vto?.threeYearPicture)}
                            ${renderOneYearPlan(node.vto?.oneYearPlan)}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderTree(data) {
            const corporate = renderCard(data, true);

            const children = (data.children || [])
                .map(child => renderCard(child, false))
                .join('');

            const html = `
                ${corporate}
                ${children ? `
                    <div class="tree-connector"></div>
                    <div class="children-container">
                        ${children}
                    </div>
                ` : ''}
            `;

            $('#tree').html(html);
        }

        $(document).ready(function() {
            renderTree(visionData);
        });
    </script>
</body>
</html>
